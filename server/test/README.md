# Интеграционные тесты для backend'а
## Тестирование
Запуск тестов: 
```sh
yarn test
```
Первые несколько секунд будет разворачиваться база данных и запускаться само приложение, потом начнут выполняться тесты. Они разделены на 3 основные группы: работа с партнёром, пользователем и хобби. Разные группы тестов выполняются независимо друг от друга. Для каждого теста выводится результат его выполнения: если тест выполнен успешно, выводится зелёная галочка, его название и, если он выполнялся довольно долго, время выполнения; если тест не пройден — название и текст ошибки.

В тестовом окружении выводятся только логи выполнения тестов, остальные отключены.

## Описание
Все основные вещи, касающиеся тестов, сложены в директории `test`:
- Сами тесты описаны в файлах, начинающихся со слова "test". Сейчас их 3: `test_provider.ts`, `test_user.ts` и `test_hobby.ts`, в каждом из них описана соответствующая группа тестов.
- Файл `sample_data.ts` хранит маленький набор тестовых данных, использующихся для проверки работы контроллеров: 2 партнёра, 2 пользователя, 6 хобби и данные для обновления записей.
- В файле `utils.ts` описаны полезные функции, не относящиеся напрямую к тестированию, но позволяющие сделать код описания тестов более лаконичным.

Для тестов используется отдельная база данных, разворачиваемая локально в `docker`-контейнере с помощью скрипта `start-db`. Файл `.mocharc.json` описывает опции для запуска тестового фреймворка `mocha`, использующегося вместе с `assertion`-библотекой `Chai` и её плагином `chai-http`, позволяющим просто работать с http-запросами.

Для всех тестов выставлен таймаут в 0,5 c. Если он вдруг окажется слишком мал для какого-то конкретного теста/группы тестов, его можно отредактировать, прописав таймаут в начале теста/группы:
```javascript
this.timeout(нужный таймаут в мс);
```
На данный момент протестированы все части контроллеров, кроме тех, что предполагают загрузку файлов в облако.